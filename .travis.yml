language: cpp
matrix:
  include:
  - os: linux
    compiler: gcc
    env:
      - COMPILER=g++-4.8
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test']
        packages: [g++-4.8]
  - os: linux
    compiler: gcc
    env:
      - COMPILER=g++-4.9
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test']
        packages: [g++-4.9]
  - os: linux
    compiler: gcc
    env:
      - COMPILER=g++-5
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test']
        packages: [g++-5]
  - os: linux
    compiler: gcc
    env:
      - COMPILER=g++-6
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test']
        packages: [g++-6]
  - os: linux
    dist: trusty
    compiler: gcc
    env:
      - COMPILER=g++-7
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test']
        packages: [g++-7]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.6 && CXX=clang++-3.6"
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.6']
        packages: [clang-3.6]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.7 && CXX=clang++-3.7"
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.7']
        packages: [clang-3.7]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.8 && CXX=clang++-3.8"
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.8']
        packages: [clang-3.8]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.9 && CXX=clang++-3.9"
    addons:
      apt:
        sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-trusty-3.9']
        packages: [clang-3.9]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-4.0 && CXX=clang++-4.0"
    addons:
      apt:
        sources: ['llvm-toolchain-trusty-4.0']
        packages: [clang-4.0]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-5.0 && CXX=clang++-5.0"
    addons:
      apt:
        sources: ['llvm-toolchain-trusty-5.0']
        packages: [clang-5.0]

before_install:
 - sudo apt-get -qq update
 - sudo apt-get install -y libgtest-dev cmake
 - sudo wget https://github.com/google/googletest/archive/release-1.7.0.tar.gz
 - sudo tar xf release-1.7.0.tar.gz
 - cd googletest-release-1.7.0
 - eval "${MATRIX_EVAL}"
 - echo $CXX
 - sudo cmake -DBUILD_SHARED_LIBS=ON .
 - sudo make
 - sudo cp -a include/gtest /usr/include
 - sudo cp -a libgtest_main.so libgtest.so /usr/lib/
 - cd "${TRAVIS_BUILD_DIR}"
before_script:
  - cd "${TRAVIS_BUILD_DIR}"
  - ls -la
  - ls -la /usr/lib/
script: 
  - $CXX main.cpp -lgtest -lgtest_main -std=c++11 -lpthread -o unit_test -Wall -Wextra -pedantic -pedantic-errors -Werror -Wfatal-errors -Wundef
  - ./unit_test
branches:
  only:
    - master
    - develop
