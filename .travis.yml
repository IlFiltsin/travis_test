language: cpp
matrix:
  include:
  - os: linux
    compiler: gcc
    env:
      - MATRIX_EVAL="CC=gcc-4.9 && CXX=g++-4.9"
      - VERSION=c++11
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test]
        packages: [g++-4.9]
  - os: linux
    compiler: gcc
    env:
      - MATRIX_EVAL="CC=gcc-5 && CXX=g++-5"
      - VERSION=c++14
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test]
        packages: [g++-5]
  - os: linux
    compiler: gcc
    env:
      - MATRIX_EVAL="CC=gcc-6 && CXX=g++-6"
      - VERSION=c++14
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test]
        packages: [g++-6]
  - os: linux
    dist: trusty
    compiler: gcc
    env:
      - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"
      - VERSION=c++17
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test]
        packages: [g++-7]
  - os: linux
    dist: trusty
    compiler: gcc
    env:
      - MATRIX_EVAL="CC=gcc-8 && CXX=g++-8"
      - VERSION=c++17
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test]
        packages: [g++-8]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.6 && CXX=clang++-3.6"
      - VERSION=c++14
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test, llvm-toolchain-precise-3.6]
        packages: [clang-3.6]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.7 && CXX=clang++-3.7"
      - VERSION=c++14
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test, llvm-toolchain-precise-3.7]
        packages: [clang-3.7]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.8 && CXX=clang++-3.8 && CXXFLAGS=libc++"
      - VERSION=c++14
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test, llvm-toolchain-precise-3.8]
        packages: [libc++-dev, clang-3.8]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-3.9 && CXX=clang++-3.9 && CXXFLAGS=libc++"
      - VERSION=c++14
    addons:
      apt:
        sources: [llvm-toolchain-trusty-3.9]
        packages: [libc++-dev, clang-3.9]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-4.0 && CXX=clang++-4.0"
      - VERSION=c++14
    addons:
      apt:
        sources: [llvm-toolchain-trusty-4.0]
        packages: [clang-4.0]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-5.0 && CXX=clang++-5.0"
      - VERSION=c++17
    addons:
      apt:
        sources: [llvm-toolchain-trusty-5.0]
        packages: [clang-5.0]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-6.0 && CXX=clang++-6.0"
      - VERSION=c++17
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test, llvm-toolchain-trusty-6.0]
        packages: [libstdc++6, clang-6.0]
  - os: linux
    compiler: clang
    env:
      - MATRIX_EVAL="CC=clang-7.0 && CXX=clang++-7.0"
      - VERSION=c++17
    addons:
      apt:
        sources: [ubuntu-toolchain-r-test, llvm-toolchain-trusty-7]
        packages: [libstdc++7, clang-7.0]
before_install:
 - sudo apt-get -qq update
 - sudo apt-get install -y libgtest-dev cmake
 - sudo wget https://github.com/google/googletest/archive/release-1.7.0.tar.gz
 - sudo tar xf release-1.7.0.tar.gz
 - cd googletest-release-1.7.0
 - eval "${MATRIX_EVAL}"
 - echo $CXX
 - sudo cmake -DBUILD_SHARED_LIBS=ON .
 - sudo make
 - sudo cp -a include/gtest /usr/include
 - sudo cp -a libgtest_main.so libgtest.so /usr/lib/
 - cd "${TRAVIS_BUILD_DIR}"
before_script:
  - cd "${TRAVIS_BUILD_DIR}"
  - ls -la
  - ls -la /usr/lib/
script: 
  - $CXX main.cpp -std=$VERSION -lgtest -lgtest_main -lpthread -o unit_test -Wall -Wextra -pedantic -pedantic-errors -Werror -Wfatal-errors -Wundef
  - ./unit_test
branches:
  only:
    - master
